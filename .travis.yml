sudo: required

language: python
python: 
    - '3.6'

services:
    - docker
  
env:
    - DOCKER_REPO=mpa
    - DOCKER_ECR_URI=496397425809.dkr.ecr.us-west-2.amazonaws.com
    - MATRIX=IDIOT

jobs:
    include:
        - stage: "Install"
          script: ".travis/install.sh"
        - stage: "Build"
          script: ".travis/build.sh" 
        - stage: "Deploy"
          script: ".travis/deploy.sh"
          if: commit_message =~ /deploy/

        # TODO: Encrypt ssh-keys into the git and use them in travis.
        # - fab setup_docker setup_aws_creds
        # - fab authenticate_docker pull_image run_container
